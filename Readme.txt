Мастерская - 1. Жизнеспособность стартапов.

Заказчик предоставил данные о стартапах, функционировавших в период с 1970 по 2018 годы.
Необходимо найти модель, которая позволит предсказать, какие из них закроются.


1. Заказчик попросил решить следующие задачи:

	1. Разработать модель машинного обучения для предсказания продолжения деятельности стартапа.
	2. Провести полноценный разведочный анализ и сформировать рекомендации будущим создателям стартапов (какие факторы влияют на успешность бизнес идеи).

    Заказчик предоставил данные в 2 файлах: тренировочный набор (около 53 тыс. записей) и тестовый набор (около 13 тыс. записей). Cтолбцы с датами в датафрейме типизированы верно, за исключением колонки 'closed_at' в тренировочных данных. Нет столбцов с неверными десятичными разделителями.
    
    Датафрейм `df_train` состоит из 52 514 строк и 13 столбцов, имеет колонки с пропусками.
    Датафрейм `df_test` состоит из 13 125  строк и 12 столбцов, имеет колонки с пропусками.
    
    Замечено, что в датафрейме `df_train` есть колонка 'closed_at' а в `df_test` она отсутствует и добавлена 'lifetime'.

2. В процессе предобработки данных:
    - наименования колонок не требовали преобразования;
    - обнаружены и заменены пропуски;
    - исправлен тип данных для признака `closed_at`, колонки с 64-битными числовыми значениями преобразованы в 32-битные для оптимизации использования памяти;
    - явных дубликатов, требующих дополнительной обработки не обнаружено. Но обнаружены дубликаты в данных без колонки `name`;
    - добавлены новые колонки: 'geo_sub_region', 'lifetime', 'founded_at_year', 'founded_at_month', 'last_fund_year', 'lifetime_category', 'main_category';
    - были найдены неявные дубликаты для нового признака `main_category`.
<br><br>

3. Предобработка потребовала незначительного удаления информации, потому 100% данных представлено к дальнейшему анализу.

4. Результат исследовательского анализа

    1. проведён исследовательский анализ признаков с помощью библиотеки YData-profiling
    2. исключены выбросы из df_train - объекты с общим объёмом инвестиций более 100 млн. долларов
    3. проведён корреляционный анализ для тренировочного и тестового датафреймов
    4. дополнительно выведены на экран корреляционные матрицы для данных с разбивкой по статусу
    5. построены диаграммы рассеяния для числовых признаков с подсветкой данных по статусу
    6. выполнен сравнительный анализ двух датафреймов, разбитых по признаку `status`
    7. выдвинута и проверена гипотеза, что между средними значениями длительности существования стартапов двух типов (действующие и закрытые) нет разницы, они равны. Гипотеза отвергнута в пользу альтернативной. Для наглядности построена сравнительная гистограмма с плотностью распределения.

    Обнаруженные особенности:
    - столбец `status` имеет дисбаланс данных (91% - operating и 9% - closed)
    - `geo_sub_region` имеет дисбаланс данных
    - `funding_total_usd` имеется сильное смещение, что говорит о наличии выбросов: 95% перцентиль около 56 млн. долларов при максимуме в 30 млрд.
    - `category list` состоит из уникальных значений на 42%
    - почти 57% значений `country_code` - это USA
    - 301 уникальное значение и 20% - California для столбца `state_code`
    - признак `funding rounds` имеет от 1 до 19 раундов с медианным значением 1 (63,8% объектов). Гистограмма сильно смещена влево
    - большинство стартапов из датасета были созданы между 2008 и 2016 годами
    - порядка 70% стартапов созданы в странах Североамериканского и Западноевропейского региона
    - минимальное `lifetime` - 17 дней. 50% стартапов живут в пределах 1740 - 4018 дней. Медианное значение 2557 дня (или 7 лет)
    - Порядка 3% стартапов были созданы и единовременно профинансированы в одну и ту же дату
    - 5-6 % компаний были впервые профинансированы даже ранее их даты создания. Это может быть ошибкой. Проинформируем об этом инженеров данных и представителей бизнеса
    - Более 50% стартапов получали инвестиции в последний раз в 2013 году.
    - 707 уникальных значений `main_catagory`. Удалось сократить количество уникальных категорий с 22 тыс. до 700.
    - колонки датафрейма df_test имеют аналогичные особенности, что и у df_train
    - признаки `founded_at_year` и `last_fund_year` имеют весьма высокую зависимость (шкала Чеддока), т.к. 63,8% имеют 1 раунд инвестирования в дату основания. Даты первого и последнего инвестирования совпадают
    - признаки `lifetime` и `lifetime_category` имеют прямую зависимость, т.к. последний был создан из колонки `lifetime`
    - признаки `country_code` и `geo_sub_region` имеют прямую зависимость, т.к. последний был создан из колонки `country_code`
    - высокую связь `country_code` и `main_category`, также как и `country_code` и `lifetime` можно объяснить большой долей уникальных значений в признаках категорий и кодов стран
    - целевой признак `status` имеет весьма высокую зависимость с колонками `lifetime`, `lifetime_category`
    - целевой признак `status` имеет крайне низкую связь с признаками `main_category`, `funding_rounds` и `funding_total_usd`
    - имеется мультиколлинеарность `status` с `lifetime`
    - нет высоких общих сумм инвестирования и раундов инвестирования для стартапов с длительным существованием
    - стартапы до 2000 гг. получали куда меньшие средства и реже, чем созданные позднее
    - закрывшиеся стартапы имеют широкий спектр вложенных в них сумм, как и раундов инвестирования
    - закрытые стартапы чаще не имеют данных о своём местоположении или категории
    - логично, что закрытые стартапы имеют гораздо чаще маленькое значение lifetime.

5. Выполнена подготовка данных для применениях в моделях машинного обучения с помощью пайплайнов. Проведена замена целевого признака с помощью LabelEncoder.

6. В рамках решения задачи классификации - прогнозирование статуса стартапа, были выбраны и обучены 3 модели:  LogisticRegression, kNN, DecisionTreeClassifier. Поиск гиперпараметров вёлся с помощью OptunaSearchCV. Метрика считалась на кросс-валидации. Лучшей моделью является логистическая регрессия. Для достоверности проведена сравнительная оценка модели с условной baseline моделью DummyClassifier. LogisticRegression показала более хорошую метрику F1: 0.998 против 0.951.
    
    Выполнен поиск лучших признаков, которые дают максимальное значение метрики F1. Таких признаков оказалось 12 из 34. Дополнительно подобран порог классификации для максимизации метрики: 0,35 вместо 0,5.
    
    Построена матрица ошибок для полученной модели со следующими результатами:
    - истинно положительные предсказания (стартап работает и модель права): 11 596
    - ложноположительные предсказания (стартап закрылся и модель ошиблась): 28
    - истинно отрицательные предсказания(стартап закрылся и модель права): 1158
    - ложноотрицательные предсказания(стартап работает и модель ошиблась): 17
    
    Найден второй путь как найти статус стартапов из тестового датафреймов с точностью 100%. Но он не подразумевает решения задачи прогнозирования с помощью моделей машинного обучения.

7. Проведена интерпретация признаков с помощью значений Шепли:
    - самыми значимыми признаками являются `lifetime` и `founded_at_year`. Чем их значение ниже, тем выше вероятность предсказание закрытия стартапа;
    - признак `last_fund_year` влияет на прогнозирование на 3 месте, и чем раньше стартап получил последние инвестиции, тем выше вероятность, что модель спрогнозирует класс 1 ('operating');
    - также заметное влияние на результат предсказания модели оказывают признаки `lifetime_category_менее 3 лет` и `geo_sub_region_no_region`. С их положительным значением растёт шанс предсказания закрытия стартапа.

8. Выполненная работа над проектом позволяет составить некоторые рекомендации:
    - бОльшая часть стартапов из предоставленного датасета находятся в странах североамериканского и западноевропейского региона. Что говорит о развитой культуре открытия новых компаний. У предпринимателя будет высокая конкуренция, но и более высокий шанс на успех;
    - количество раундов инвестирования и общая сумма финансирования не сильно влияют на жизнеспособность стратапа;
    - наиболее большое количество как действующих, так и закрытых стартапов работают в сфере биотехнологий, разработки приложений, web-приложений, электронной коммерции и рекламы. Учитывая несбалансированность количества действующих и закрытых стартапов в пользу первых, участие предпринимателя в указанных сферах предоставят высокие шансы на успех;
    - медианное время жизни закрывшегося стартапа - 3 года. Важно преодолеть этот период.
